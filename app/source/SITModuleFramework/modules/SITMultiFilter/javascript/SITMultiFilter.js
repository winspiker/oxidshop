var mf_rewriteBase="";var mf_maxArticlesPerPage=12;var mf_enableFilterCount=0;var mf_noArticlesFoundText="";var mf_infiniteScrolling=null;var mf_useLayoutAccordeon=null;var mf_useLayoutAccordeonOpenFirst=true;var mf_useLayoutAccordeonOpenOnLoad=true;var mf_alwaysDisplayContentId="";var mf_mainContainerId="boxwrapper_productList";var mf_containerIdFilterContent="mf_filterContent";var mf_navigationContainerId="mf_productNavigator";var mf_navigationContainerIdBottom="mf_productNavigatorBottom";var mf_articleContainerId="mf_productList";var mf_filterContainerId="mf_filterList";var mf_sortField="";var mf_sortOrder="asc";var mf_currentPage=0;var mf_currentPageInfiniteScrolling=0;var mf_infiniteScrollingBound=false;var mf_menuOpenedArray=new Object();var mf_articleArray=new Array();var mf_categoryId="";var mf_sessionId="";var mf_sessionToken="";var mf_languageId=0;var mf_currencyId="";var mf_contentStart="";var mf_shopId="";var mf_clearCache=false;var mf_specialFilter="";var mf_lastOption=null;var mf_sliderMinPrice=0;var mf_sliderMinPriceTop=0;var mf_sliderMaxPrice=0;var mf_sliderMaxPriceLow=0;function mf_loadHtmlArticles(c,f){var e=mf_loadHtmlArticlesCheckStandardContentVisibility();if(e){$("#"+mf_articleContainerId).html("");return}var a={};a.request="article";a.article_array=c;a.category_id=mf_categoryId;var d=$.ajax({type:"POST",async:false,url:mf_rewriteBase+"index.php?cl=sit_multifilter_loader",data:a,dataType:"html",success:function(g){if(f){$("#"+mf_articleContainerId).append(g)}else{$("#"+mf_articleContainerId).html(g)}}});if(typeof mf_loadHtmlArticlesHook=="function"){mf_loadHtmlArticlesHook()}if(mf_infiniteScrolling!="1"){return}if(Object.keys(c).length>0){$("#"+mf_articleContainerId).append('<div id="infiniteScroll">&nbsp;</div>')}if(mf_infiniteScrollingBound==false){mf_infiniteScrollingBound=true;var b=null;$(window).bind("scroll",function(){clearTimeout(b);b=setTimeout(mf_loadHtmlArticlesCheckInfiniteScrolling(),250)})}}function mf_loadHtmlArticlesCheckInfiniteScrolling(){if(!$("#"+mf_articleContainerId).is(":visible")){return}var a=$("#"+mf_articleContainerId).find("#infiniteScroll");if(a.length>0&&mf_coreIsScrolledIntoView(a)){a.remove();mf_currentPageInfiniteScrolling=mf_currentPageInfiniteScrolling+1;mf_coreStartFilterRequest(false,false,true,true)}}function mf_loadHtmlArticlesCheckStandardContentVisibility(){var e=$("#"+mf_filterContainerId).find("input:checked").length;$("#"+mf_filterContainerId).find("select option:selected").each(function(){if($(this).val()=="-999"){return}e++});var d=0;var a=0;var b=0;var c=0;if($("#sitMultifilterPriceSlider").length){d=$("#sitMultifilterPriceSlider").slider("option","min");a=$("#sitMultifilterPriceSlider").slider("option","max");b=$("#sitMultifilterPriceSlider").slider("values",0);c=$("#sitMultifilterPriceSlider").slider("values",1)}if(e==0&&mf_contentStart!=""&&d==b&&a==c){$("#"+mf_mainContainerId).contents().each(function(){if($(this).attr("id")!=mf_containerIdFilterContent&&$(this).attr("id")!=mf_navigationContainerId&&$(this).attr("id")!=mf_articleContainerId&&$(this).attr("id")!=mf_navigationContainerIdBottom){$(this).removeClass("mf_displayNone")}});$("#"+mf_mainContainerId).parent().find(".listRefine").show();$("#"+mf_mainContainerId).parent().find(".refineParams").show();$("#"+mf_mainContainerId+" #"+mf_containerIdFilterContent).hide();$("#"+mf_mainContainerId+" #"+mf_navigationContainerId).hide();$("#"+mf_mainContainerId+" #"+mf_articleContainerId).hide();if(mf_infiniteScrolling!="1"){$("#"+mf_mainContainerId+" #"+mf_navigationContainerIdBottom).hide()}return true}else{$("#"+mf_mainContainerId).contents().each(function(){if($(this).attr("id")!=mf_containerIdFilterContent&&$(this).attr("id")!=mf_navigationContainerId&&$(this).attr("id")!=mf_articleContainerId&&$(this).attr("id")!=mf_navigationContainerIdBottom&&$(this).attr("id")!=mf_alwaysDisplayContentId){$(this).addClass("mf_displayNone")}});$("#"+mf_mainContainerId).parent().find(".listRefine").hide();$("#"+mf_mainContainerId).parent().find(".refineParams").hide();$("#"+mf_mainContainerId+" #"+mf_containerIdFilterContent).show();$("#"+mf_mainContainerId+" #"+mf_navigationContainerId).show();$("#"+mf_mainContainerId+" #"+mf_articleContainerId).show();if(mf_infiniteScrolling!="1"){$("#"+mf_mainContainerId+" #"+mf_navigationContainerIdBottom).show()}return false}}function mf_loadHtmlFilter(a){$("#"+mf_filterContainerId).html(a.filterHtml);mf_loadHtmlFilterCheckFilterMenus();mf_loadHtmlFilterCheckFilterSlider();mf_loadHtmlFilterCheckFilterSearch();$("#"+mf_filterContainerId).find("#sitMultifilterHeader").bind("click",function(){$("#"+mf_filterContainerId).find(".sitMultifilterGroup").each(function(){if($(this).is(":visible")){$(this).addClass("hidden-xs")}else{$(this).removeClass("hidden-xs")}})});$("#"+mf_filterContainerId).find("#sitMultifilterForm :checkbox").each(function(){$(this).bind("click",function(){mf_currentPage=0;mf_currentPageInfiniteScrolling=0;mf_coreStartFilterRequest(true,true,true,true);mf_setSeoURL($(this).data("url"),$(this).data("currenturl"))})});$("#"+mf_filterContainerId).find("#sitMultifilterForm select").each(function(){$(this).bind("focus",function(){mf_lastOption=$(this).find("option:selected")});$(this).bind("change",function(){mf_currentPage=0;mf_currentPageInfiniteScrolling=0;mf_coreStartFilterRequest(true,true,true,true);if($(this).find("option:selected").attr("value")=="-999"){mf_setSeoURL(mf_lastOption.data("url"),mf_lastOption.data("currenturl"))}else{mf_setSeoURL($(this).find("option:selected").data("url"),$(this).find("option:selected").data("currenturl"))}})});$("#"+mf_filterContainerId).find("#sitMultifilterGroupReset").each(function(){$(this).bind("click",function(){var b=$(this).closest(".sitMultifilterGroup").attr("id");mf_setFilter("");mf_resetFilter(b,true)})});$("#"+mf_filterContainerId).find("#sitMultifilterGroupResetAll").each(function(){$(this).bind("click",function(){mf_setFilter("");mf_resetFilter("ALL",false)})});$("#"+mf_containerIdFilterContent).html(a.filterContentHtml);$("#"+mf_containerIdFilterContent).find("#sitMultifilterResetAll").each(function(){$(this).bind("click",function(){mf_setFilter("");mf_resetFilter("ALL",false)})});$("#"+mf_containerIdFilterContent).find(".dropdownlabel").each(function(){$(this).bind("click",function(){var b=$(this).attr("id");mf_setFilter("");mf_resetFilter(b,true)})});$("#"+mf_containerIdFilterContent).find("label[for^='pricefilter']").each(function(){$(this).bind("click",function(){mf_resetFilter("pricefilter",false)})});if(typeof mf_loadHtmlFilterHook=="function"){mf_loadHtmlFilterHook()}}function mf_setSeoURL(d,f){if(mf_categoryId=="search"){return}var a=window.location.href;a=a.replace(f,"");if(a.indexOf("?")!=-1){var c=a.substr(0,a.indexOf("?"));var b=a.substr(a.indexOf("?"));a=c+d+b}else{a+=d}var e={};var g="";history.pushState(e,g,a)}function mf_loadHtmlFilterCheckFilterMenus(){var a=0;$("#"+mf_filterContainerId).find("#sitMultifilterForm .sitMultifilterGroup > span").each(function(){$(this).bind("click",function(){var d=$(this).closest(".sitMultifilterGroup").attr("id");$("#"+mf_filterContainerId).find("#sitMultifilterForm .sitMultifilterGroup > span").each(function(){var e=$(this).closest(".sitMultifilterGroup").attr("id");if(d==e){if($(this).closest(".sitMultifilterGroup").find("ul").is(":visible")){$(this).addClass("closed");delete mf_menuOpenedArray[d]}else{$(this).removeClass("closed");mf_menuOpenedArray[d]=d}$(this).closest(".sitMultifilterGroup").find("ul").slideToggle()}else{if(mf_useLayoutAccordeon=="1"){$(this).addClass("closed");delete mf_menuOpenedArray[e];$(this).closest(".sitMultifilterGroup").find("ul").slideUp()}}})});var c=false;$(this).closest(".sitMultifilterGroup").find("label").each(function(){if($(this).hasClass("active")){c=true}});if(!c){$(this).closest(".sitMultifilterGroup ul").hide()}var b=$(this).closest(".sitMultifilterGroup").attr("id");if((Object.keys(mf_menuOpenedArray).length==0&&a==0&&mf_useLayoutAccordeonOpenFirst&&mf_useLayoutAccordeonOpenOnLoad)||(Object.keys(mf_menuOpenedArray).length>0&&b in mf_menuOpenedArray&&mf_useLayoutAccordeonOpenOnLoad)){$(this).closest(".sitMultifilterGroup").find("ul").show();$(this).removeClass("closed");mf_menuOpenedArray[b]=b}else{if(mf_useLayoutAccordeon=="1"){$(this).closest(".sitMultifilterGroup").find("ul").hide();$(this).addClass("closed")}}a++})}function mf_loadHtmlFilterCheckFilterSlider(){if(!$("#sitMultifilterPriceSlider").length){return}var a=$("#sitMultifilterPriceSliderCurrency").val();var b=$("#sitMultifilterPriceSliderFilter").val();var e=b.split(",")[0];var d=b.split(",")[1];var c=$("#sitMultifilterPriceSlider").slider({range:true,min:mf_sliderMinPrice,max:mf_sliderMaxPrice,values:[e,d],slide:function(g,h){var i=h.values[0];var f=h.values[1];if(i>mf_sliderMinPriceTop||f<mf_sliderMaxPriceLow){return false}$("#sitMultifilterPriceSliderAmount").html(h.values[0]+" - "+h.values[1]+" "+a);$("#sitMultifilterPriceSliderFilter").val(h.values[0]+","+h.values[1])},stop:function(g,h){mf_currentPage=0;mf_currentPageInfiniteScrolling=0;mf_coreStartFilterRequest(true,true,true,true);var j=h.values[0];var f=h.values[1];if(j!=mf_sliderMinPrice||f!=mf_sliderMaxPrice){var i=$(this).data("url");i=i.replace("PRICE_FROM",j);i=i.replace("PRICE_TO",f);mf_setSeoURL(i,$(this).data("currenturl"))}else{mf_setSeoURL($(this).data("reseturl"),$(this).data("currenturl"))}}});$("#sitMultifilterPriceSliderAmount").html($("#sitMultifilterPriceSlider").slider("values",0)+" - "+$("#sitMultifilterPriceSlider").slider("values",1)+" "+a)}function mf_loadHtmlFilterCheckFilterSearch(){var a=0;$("#"+mf_filterContainerId).find(".sitMultifilterGroup").each(function(){var d=$(this);var c=d.find('input[name="sitMultifilterGroupSearchfield"]');if(!c.length){return}var b=0;d.find("label").each(function(){if($(this).hasClass("active")){b++}});if(b<mf_enableFilterCount||mf_enableFilterCount==0){c.parent().hide();return}c.attr("autocomplete","off");c.bind("keyup",function(f){var e=c.val();mf_loadHtmlFilterCheckFilterSearchProcess(d,e)})})}function mf_loadHtmlFilterCheckFilterSearchProcess(b,a){b.find(".sitMultifilterGroupEntry").each(function(){var c=$(this).attr("value");if(c.toLowerCase().indexOf(a.toLowerCase())==-1){$(this).parent().hide()}else{$(this).parent().show()}})}function mf_setFilter(b){var a={};a.request="filterset";a.categoryId=mf_categoryId;a.filter=b;a.shop_id=mf_shopId;a.shopId=mf_shopId;$.ajax({type:"POST",async:false,url:mf_rewriteBase+"SITModuleFramework/modules/SITMultiFilter/SITMultiFilterConfigurator.php",data:a,dataType:"json",success:function(c){}})}function mf_resetFilter(c,f){var b="";var d="";$("#"+mf_filterContainerId).find("#sitMultifilterForm input:checked").each(function(){if($(this).attr("name")==c||c=="ALL"){$(this).attr("checked",false);if(c!="ALL"&&!f){mf_setSeoURL($(this).data("url"),$(this).data("currenturl"))}else{if(f){b=$(this).data("reseturl");d=$(this).data("currenturl")}}}});$("#"+mf_filterContainerId).find("#sitMultifilterForm select").each(function(){if($(this).attr("name")==c||c=="ALL"){mf_lastOption=$(this).find("option:selected");$(this).find("option:first-child").attr("selected",true);if(c!="ALL"&&!f){mf_setSeoURL(mf_lastOption.data("url"),mf_lastOption.data("currenturl"))}}});if($("#sitMultifilterPriceSliderFilter").length){if("pricefilter"==c||c=="ALL"){$("#sitMultifilterPriceSliderFilter").val(mf_sliderMinPrice+","+mf_sliderMaxPrice);if(c!="ALL"&&!f){mf_setSeoURL($("#sitMultifilterPriceSlider").data("reseturl"),$("#sitMultifilterPriceSlider").data("currenturl"))}}}if(c=="ALL"){var a=window.location.href;var e=a.substring(a.indexOf("mf/"));mf_setSeoURL("",e)}else{if(f){mf_setSeoURL(b,d)}}mf_coreStartFilterRequest(true,true,true,true)}function mf_loadHtmlNavigation(a){$("#"+mf_navigationContainerId).html(a);$("#"+mf_navigationContainerId).find(".sitResultNavigationPages a").each(function(){$(this).unbind("click");$(this).bind("click",function(){mf_handleSelectionNavigation(parseInt($(this).attr("id")),"","");return false})});$("#"+mf_navigationContainerId).find(".sitResultNavigationSorts a").each(function(){$(this).unbind("click");$(this).bind("click",function(){mf_handleSelectionNavigation("",$(this).attr("id"),"");return false})});$("#"+mf_navigationContainerId).find(".sitResultNavigationCounts a").each(function(){$(this).unbind("click");$(this).bind("click",function(){mf_handleSelectionNavigation("","",parseInt($(this).attr("id")));return false})});if($("#"+mf_navigationContainerIdBottom).length){$("#"+mf_navigationContainerIdBottom).html(a);$("#"+mf_navigationContainerIdBottom).find(".sitResultNavigationPages a").each(function(){$(this).unbind("click");$(this).bind("click",function(){mf_handleSelectionNavigation(parseInt($(this).attr("id")),"","");return false})});$("#"+mf_navigationContainerIdBottom).find(".sitResultNavigationSorts a").each(function(){$(this).unbind("click");$(this).bind("click",function(){mf_handleSelectionNavigation("",$(this).attr("id"),"");return false})});$("#"+mf_navigationContainerIdBottom).find(".sitResultNavigationCounts a").each(function(){$(this).unbind("click");$(this).bind("click",function(){mf_handleSelectionNavigation("","",parseInt($(this).attr("id")));return false})})}mf_loadHtmlNavigationCheckNavigationMenus();if(typeof mf_loadHtmlNavigationHook=="function"){mf_loadHtmlNavigationHook()}}function mf_loadHtmlNavigationCheckNavigationMenus(){$("#"+mf_navigationContainerId).find("h4").each(function(){$(this).closest("div").find("ul").hide();$(this).bind("click",function(){var a=$(this).closest("div");$("#"+mf_navigationContainerId).find("h4").each(function(){var b=$(this).closest("div");if(a[0]==b[0]){if($(this).closest("div").find("ul").is(":visible")){$(this).addClass("closed")}else{$(this).removeClass("closed")}$(this).closest("div").find("ul").slideToggle()}else{$(this).addClass("closed");$(this).closest("div").find("ul").slideUp()}})})});if($("#"+mf_navigationContainerIdBottom).length){$("#"+mf_navigationContainerIdBottom).find("h4").each(function(){$(this).closest("div").find("ul").hide();$(this).bind("click",function(){var a=$(this).closest("div");$("#"+mf_navigationContainerIdBottom).find("h4").each(function(){var b=$(this).closest("div");if(a[0]==b[0]){if($(this).closest("div").find("ul").is(":visible")){$(this).addClass("closed")}else{$(this).removeClass("closed")}$(this).closest("div").find("ul").slideToggle()}else{$(this).addClass("closed");$(this).closest("div").find("ul").slideUp()}})})})}}function mf_handleSelectionNavigation(c,a,b){if(parseInt(c)>=0){mf_currentPage=c;mf_currentPageInfiniteScrolling=c}else{mf_currentPage=0;mf_currentPageInfiniteScrolling=0}if(a!=""){var d=a.split("_");if(d.length==2){mf_sortField=d[0];mf_sortOrder=d[1]}else{mf_sortField=a}}if(parseInt(b)>=1){mf_maxArticlesPerPage=b}mf_coreStartFilterRequest(false,true,true,true)}function mf_coreIsScrolledIntoView(c){var e=$(window).scrollTop();var d=e+$(window).height();var a=$(c).offset().top;var b=a+$(c).height();return((b<=d)&&(a>=e))}function mf_coreStartFilterRequest(f,d,e,c){if(mf_infiniteScrolling==null){mf_coreLoadConfigSettings();if(!$("#"+mf_mainContainerId).length){mf_mainContainerId="content"}}if((!$("#"+mf_navigationContainerId).length)&&$("#"+mf_mainContainerId).length){mf_contentStart=$("#"+mf_mainContainerId).html();$("#"+mf_mainContainerId).append('<div id="'+mf_containerIdFilterContent+'"></div>');$("#"+mf_mainContainerId).append('<div id="'+mf_navigationContainerId+'"></div>');$("#"+mf_mainContainerId).append('<div id="'+mf_articleContainerId+'"></div>');if(mf_infiniteScrolling!="1"){$("#"+mf_mainContainerId).append('<div id="'+mf_navigationContainerIdBottom+'"></div>')}}var b={};$.each($("#sitMultifilterForm").serializeArray(),function(j,k){if(k.value=="-999"){return}if(k.name=="pricefilter"){if($("#sitMultifilterPriceSliderFilter").val()==(mf_sliderMinPrice+","+mf_sliderMaxPrice)){return}}else{if(k.name=="sitMultifilterGroupSearchfield"||mf_stringStartsWith(k.name,"sitMultifilterDirect")){return}}var h=new Array();if(b[k.name]){h=b[k.name]}h.push(k.value);b[k.name]=h});if(f&&d&&e&&c){if(Object.keys(b).length==0){mf_setFilter("")}}var a={};a.request="startFilterRequest";a.loadFilter=f;a.loadNavigation=d;a.selectedFilter=b;a.categoryId=mf_categoryId;a.sessionId=mf_sessionId;a.sessionToken=mf_sessionToken;var g=false;if(!f&&!d&&e){g=true;a.currentPage=mf_currentPageInfiniteScrolling}else{a.currentPage=mf_currentPage}a.maxArticlesPerPage=mf_maxArticlesPerPage;a.sortField=mf_sortField;a.sortOrder=mf_sortOrder;a.languageId=mf_languageId;a.currencyId=mf_currencyId;a.specialFilter=mf_specialFilter;a.shop_id=mf_shopId;a.shopId=mf_shopId;if(f){mf_startLoaderAnimationFilter()}if(e&&$("#"+mf_mainContainerId).is(":visible")){mf_startLoaderAnimationArticleList()}$.ajax({type:"POST",async:true,url:mf_rewriteBase+"SITModuleFramework/modules/SITMultiFilter/SITMultiFilterConfigurator.php",data:a,dataType:"json",success:function(h){if(f){mf_loadHtmlFilter(h);mf_endLoaderAnimationFilter()}if(d||h.sessionFilterLoaded){mf_loadHtmlNavigation(h.navigationHtml)}if(e||h.sessionFilterLoaded){mf_loadHtmlArticles(h.articleIdArray,g);mf_endLoaderAnimationArticleList();if(!g&&!mf_coreIsScrolledIntoView($("#"+mf_navigationContainerId))){$("html, body").animate({scrollTop:($("#"+mf_navigationContainerId).offset().top)},"slow")}}}})}function mf_startLoaderAnimationArticleList(){$("#"+mf_mainContainerId).css("opacity","0.3");$("#"+mf_articleContainerId).css("background","url("+mf_rewriteBase+"SITModuleFramework/lib/img/sit-loader-big.gif) no-repeat center")}function mf_endLoaderAnimationArticleList(){$("#"+mf_mainContainerId).css("opacity","1");$("#"+mf_articleContainerId).css("background","none")}function mf_startLoaderAnimationFilter(){$("#"+mf_filterContainerId+" #sitMultifilterForm").css("opacity","0.3");$("#"+mf_filterContainerId).css("background","url("+mf_rewriteBase+"SITModuleFramework/lib/img/sit-loader-big.gif) no-repeat center")}function mf_endLoaderAnimationFilter(){$("#"+mf_filterContainerId+" #sitMultifilterForm").css("opacity","1");$("#"+mf_filterContainerId).css("background","none")}function mf_stringStartsWith(a,b){return a.slice(0,b.length)==b}function mf_coreLoadConfigSettings(){var a={};a.request="loadConfigSettings";a.categoryId=mf_categoryId;a.clearCache=mf_clearCache;a.shop_id=mf_shopId;a.shopId=mf_shopId;$.ajax({type:"POST",async:false,url:mf_rewriteBase+"SITModuleFramework/modules/SITMultiFilter/SITMultiFilterConfigurator.php",data:a,dataType:"json",success:function(b){if(typeof b.article_per_page!=="undefined"&&b.article_per_page!=""){mf_maxArticlesPerPage=b.article_per_page}if(typeof b.sitMultiflterEnableFilterCount!=="undefined"&&b.sitMultiflterEnableFilterCount!=""){mf_enableFilterCount=b.sitMultiflterEnableFilterCount}if(typeof b.no_articles_found_text!=="undefined"&&b.no_articles_found_text!=""){mf_noArticlesFoundText=b.no_articles_found_text}if(typeof b.infinite_scrolling!=="undefined"&&b.infinite_scrolling!=""){mf_infiniteScrolling=b.infinite_scrolling}if(typeof b.sitMultifilterUseAccordeon!=="undefined"&&b.sitMultifilterUseAccordeon!=""){mf_useLayoutAccordeon=b.sitMultifilterUseAccordeon}}})};