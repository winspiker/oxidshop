/*
 jQuery Magnify Plugin v2.1.0 by T. H. Doan (http://thdoan.github.io/magnify/)
 Based on http://thecodeplayer.com/walkthrough/magnifying-glass-for-images-using-jquery-and-css3

 jQuery Magnify by T. H. Doan is licensed under the MIT License.
 Read a copy of the license in the LICENSE file or at http://choosealicense.com/licenses/mit
*/
(function(e){e.fn.magnify=function(a){a=e.extend({src:"",speed:100,timeout:-1,finalWidth:null,finalHeight:null,magnifiedWidth:null,magnifiedHeight:null,limitBounds:!1,afterLoad:function(){}},a);var d=this,D=e("html"),G=function(h){var b=e(h),w=b.closest("a"),c={},d;for(d in a)c[d]=b.attr("data-magnify-"+d.toLowerCase());var x=c.src||a.src||w.attr("href")||"";if(x){var k,g,q,p,l,m,r,t,y=0,z=0,A,u,v=function(){var a=k.offset();u={top:b.offset().top-a.top+parseInt(b.css("border-top-width"))+parseInt(b.css("padding-top")),
left:b.offset().left-a.left+parseInt(b.css("border-left-width"))+parseInt(b.css("padding-left"))};a.top+=u.top;a.left+=u.left;return a},B=function(){g.is(":visible")&&g.fadeOut(a.speed,function(){D.removeClass("magnifying").trigger("magnifyend")})};isNaN(+c.speed)||(a.speed=+c.speed);isNaN(+c.timeout)||(a.timeout=+c.timeout);isNaN(+c.finalWidth)||(a.finalWidth=+c.finalWidth);isNaN(+c.finalHeight)||(a.finalHeight=+c.finalHeight);isNaN(+c.magnifiedWidth)||(a.magnifiedWidth=+c.magnifiedWidth);isNaN(+c.magnifiedHeight)||
(a.magnifiedHeight=+c.magnifiedHeight);"true"===c.limitBounds&&(a.limitBounds=!0);"function"===typeof window[c.afterLoad]&&(a.afterLoad=window[c.afterLoad]);b.data("originalStyle",b.attr("style"));var n=new Image;e(n).on({load:function(){var d,h;b.css("display","block");b.parent(".magnify").length||b.wrap('<div class="magnify"></div>');k=b.parent(".magnify");b.prev(".magnify-lens").length?k.children(".magnify-lens").css("background-image","url('"+x+"')"):b.before('<div class="magnify-lens loading" style="background:url(\''+
x+"') 0 0 no-repeat\"></div>");g=k.children(".magnify-lens");g.removeClass("loading");q=a.finalWidth||b.width();p=a.finalHeight||b.height();l=a.magnifiedWidth||n.width;m=a.magnifiedHeight||n.height;r=g.width();t=g.height();A=v();a.limitBounds&&(y=r/2/(l/q),z=t/2/(m/p));l===n.width&&m===n.height||g.css("background-size",l+"px "+m+"px");b.data("zoomSize",{width:l,height:m});n=null;a.afterLoad();k.off().on({"mousemove touchmove":function(f){f.preventDefault();if(p){if(d=(f.pageX||f.originalEvent.touches[0].pageX)-
A.left,h=(f.pageY||f.originalEvent.touches[0].pageY)-A.top,g.is(":animated")||(d>y&&d<q-y&&h>z&&h<p-z?g.is(":hidden")&&(D.addClass("magnifying").trigger("magnifystart"),g.fadeIn(a.speed)):B()),g.is(":visible")){f="";if(l&&m){f=-Math.round(d/q*l-r/2);var b=-Math.round(h/p*m-t/2);if(a.limitBounds){var c=-Math.round((q-y)/q*l-r/2),e=-Math.round((p-z)/p*m-t/2);0<f?f=0:f<c&&(f=c);0<b?b=0:b<e&&(b=e)}f=f+"px "+b+"px"}g.css({top:Math.round(h-t/2)+u.top+"px",left:Math.round(d-r/2)+u.left+"px","background-position":f})}}else C()},
mouseenter:function(){A=v()},mouseleave:B});if(0<=a.timeout)k.on("touchend",function(){setTimeout(B,a.timeout)});e("body").not(k).on("touchstart",B);var E=b.attr("usemap");if(E){var F=e("map[name="+E.slice(1)+"]");b.after(F);k.click(function(a){if(a.clientX||a.clientY)g.hide(),a=document.elementFromPoint(a.clientX||a.originalEvent.touches[0].clientX,a.clientY||a.originalEvent.touches[0].clientY),"AREA"===a.nodeName?a.click():e("area",F).each(function(){var a=e(this).attr("coords").split(",");if(d>=
a[0]&&d<=a[2]&&h>=a[1]&&h<=a[3])return this.click(),!1})})}w.length&&(!w.attr("href")||c.src||a.src||w.click(function(a){a.preventDefault()}))},error:function(){n=null}});n.src=x}},v=0,C=function(){clearTimeout(v);v=setTimeout(function(){d.destroy();d.magnify(a)},100)};this.destroy=function(){this.each(function(){var a=e(this),b=a.prev("div.magnify-lens"),d=a.data("originalStyle");a.parent("div.magnify").length&&b.length&&(d?a.attr("style",d):a.removeAttr("style"),b.remove())});e(window).off("resize",
C);return d};e(window).resize(C);return this.each(function(){G(this)})}})(jQuery);